<!DOCTYPE html>
<html>
<head>
	<title>Invite Candidate to the Symantec Online Coding Problem</title>
	<meta charset="utf-8"/>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>

<script type="text/javascript" src="/js/config.js" ></script>	
<script type="text/javascript" src="/js/utils.js" ></script>	

<script type="text/javascript">

function prefill()
{
	if (Cookies.get("manager_email") != null)
	{
		$('#manager_email').val(Cookies.get('manager_email'));
		$('#remember_me').prop( "checked", Cookies.get('remember_me'));
	}
}

function save()
{
  if ($('#remember_me').is(':checked'))
  {
  	Cookies.set('manager_email', $('#manager_email').val());
  	Cookies.set('remember_me', $('#remember_me').is(':checked'));
  }
  else
  {
  	Cookies.remove("manager_email", null);
  	Cookies.remove("remember_me", null);
  }
}

$(document).ready(function(){

	prefill();


	$('#invite-form').submit(function (event) {

	  event.preventDefault();
		
	  save();

	  if(!confirm("Confirm?")) {
	  	return;
	  }

	  $('#invite-form').hide();
	  $('#results').html("Generating problem and emailing candidate...")

	  var data = {
	    candidateFirstName: $('#first-name').val(),
	    candidateLastName: $('#last-name').val(),
	    candidateEmail: $('#email').val(),
	    managerEmail: $('#manager_email').val()
	  }

	  $.ajax({
	    type: 'POST',
	    url: inviteAPIURL,
	    dataType: 'text',
	    contentType: 'application/json',
	    data: JSON.stringify(data),
	    crossDomain: true,
	    success: function () {
	      	$('#results').html('<span class="success">Invite succeeded.  You may wish to notify your candidate to expect an email.<br/><br/>They may need to check their junk folder, or notify <a href="mail://andrew_chang@symantec.com">andrew_chang@symantec.com</a>.</span>');
	    },
		error: function(XMLHttpRequest, textStatus, errorThrown) {
	      	$('#results').html('<span class="fail">Invite failed. Please refresh the page and try again; or notify <a href="mail://andrew_chang@symantec.com">andrew_chang@symantec.com</a></span>');

	  		$('#invite-form').show();
		}
	  })

	});

});

</script>

<style>
p.h1 {
	font-weight: bold;
	font-size: 40px;

}

p.h2 {
	font-weight: bold;
	font-size: 24px;

}

body {

	width: 800px;
	margin-left: 100px;
}

#invite-form {
	
	border-color: red;
}

.success {
	color: green;
}

.fail {
	color: red;
}

.warning
{
	font-weight: bold;
	font-size: 18px;
	font-style: italic;

}

input.email {
	min-width: 200px;
}

div.candidate, div.manager {
	width:800px;
	border-style: solid;
	padding: 10px;
	padding-top: 0px;
	margin-bottom: 20px;
}

p.formheading {

	font-weight: bold;
	font-size: 18px;
}

</style>
</head>
<body>

<div id="instructions">
<p class="h1">Online Coding Invite Page<br/>Symantec Hiring Managers</p>

<p class="h2">Instructions:</p>
<p>Complete and submit the form below.</p>
<p>This portal will email candidates a link to their temporary online coding problem page.</p>
<p>Candidates will have 48 hours to complete the exercise once they have begun.</p>
<p>You will recieve email notifications throughout the process.</p>
<p>For any questions or issues, please email <a href="mailto://andrew_chang@symantec.com">andrew_chang@symantec.com</a>.</p>

</div>

<br>

<p class="h2">Invite candidate:</p>
<form id="invite-form" class="invite-form">
	<div class=candidate>
		<p class=formheading>Candidate</p>
		<p>
		  <label for="first-name">Candidate first name:</label>
		  <input type="text" id="first-name" placeholder="first name..." required/>
		 </p>

		<p>
		  <label for="last-name">Candidate last name:</label>
		  <input type="text" id="last-name" placeholder="last name..." required/>
		 </p>

		<p>	 
		  <label for="email">Candidate email:</label>
		  <input class=email type="email" id="email" placeholder="email..." required/>
		</p>
	</div>
	<div class=manager>
		<p class=formheading>Hiring manager</p>
		<p>	 
		  <label for="manager_email">Your email:</label>
		  <input class=email type="email" id="manager_email" placeholder="hiring manager email..." required/>
		</p>
		<p>	 
		  <input type="checkbox" id="remember_me"/>
		  <label for="remember_me">Remember me (only check if you agree to allow this page to use cookies)</label>
		</p>
	</div>

  <button type="submit">Send invite</button>
</form>

<span id="results"></span>

</body>
